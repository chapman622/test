async function fetchStaff() {
  try {
    const serverUrl = serverUrlBase + "?v=" + Date.now(); // bypass cache
    const res = await fetch(serverUrl);
    const data = await res.json();

    // Debug: log all players and staff flag
    console.log("Players fetched:");
    (data.players || []).forEach(p => {
      console.log(`${p[0]} â†’ staff: ${p[4]}`);
    });

    // Safe filter for staff
    const staffMembers = (data.players || []).filter(
      p => Array.isArray(p) && p[4] === true
    );

    if (staffMembers.length === 0) {
      staffListEl.innerHTML = "<i>No staff online</i>";
      box.style.height = HEADER_HEIGHT + PADDING + "px";
      headerTitle.textContent = "Online Staff (0)";
      headerTitle.style.color = "red";
    } else {
      staffListEl.innerHTML = staffMembers.map(p => `
        <div class="staff-member">
          <img src="${p[3]}" alt="avatar">
          <div>
            <div class="staff-name">${p[0]}</div>
            <div class="staff-job">${p[5]}</div>
          </div>
        </div>
      `).join("");

      const staffCount = staffMembers.length;
      const newHeight = HEADER_HEIGHT + staffCount * ROW_HEIGHT + PADDING;
      const maxHeight = window.innerHeight - 50;
      const minHeight = 100;
      box.style.height = Math.max(minHeight, Math.min(newHeight, maxHeight)) + "px";

      headerTitle.textContent = `Online Staff (${staffCount})`;
      headerTitle.style.color = "limegreen";
    }

  } catch(err) {
    staffListEl.innerHTML = "<i>Error fetching staff</i>";
    console.error(err);
    headerTitle.textContent = "Online Staff (?)";
    headerTitle.style.color = "orange";
  }
}
